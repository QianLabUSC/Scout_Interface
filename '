
# mocapCollection:
#   ros__parameters:
#     localIP: 

# protocols to change:
# goal color change (current blue is not visible) (low priority)
# how do we adding another goal (publish a goal point) (low priority)
# change the terrain shape to x : 10 m, y is 4 m.  (the zero coordinates will have change based on read world coordinates)
# create a map similar to the image (high priority) (create a gp to make ground truth publisher)
# testing the scouting algorihthm to make it work



foxglove_bridge:
  ros__parameters:
    topic_whitelist: 
      # - '.*'
      # - '/spirit/state_low_speed'
      # - '/spirit/current_pose'
      - '/rosout'
      - '/spirit/robot_path'
      - '/scout_map/spatial_measurements_markers'
      - '/scout_map/extrapolated_map'
      - '/scout_map/extrapolated_map_colorbar'
      - '/spirit/raw_measurements'
      - '/spirit/raw_pene_measurements'
      - '/spirit/spatial_measurements'
      - '/spirit/current_pose_marker'
      - '/freespace_markers'
      # - '/goal_marker'  
      - '/goal_markers'  
      - '/concave_markers'  
      - '/projected_goal_marker'
      - '/merged_polygon_markers'  
      - '/ground_truth_map'
      - '/input_goal_point'
      - '/envelope_markers'
      - '/obstacle_centers_markers'
      - '/clipped_polygon_markers'
      - '/transformed_position_marker'
      - '/local_goal_marker'
      - '/free_space_line_marker'
      - '/subgoal_marker'

      # - '/spirit/gps'
      # - '/spirit/detail_gps'
      # - '/spirit/reference_point_update'
      # - '/spirit/gps/reference_point'
      # - '/payload/camera/front/rgb/compressed'
      # - '/payload/camera/front/depth/compressed'
      # - '/payload/camera/back/rgb/compressed'
      # - '/payload/camera/back/depth/compressed'
      # - '/payload/camera/navigation/rgb/compressed'
      # - '/payload/camera/navigation/depth/compressed'

    


top_view_camera:
  ros__parameters:

data_collector:
  ros__parameters:
    csv_file: safe_scouting_testjan26
    enable_visualization: true

mapping_node:
  ros__parameters:
    x_range: [0.0, 20.0]
    y_range: [0.0, 20.0] # if set auto_x_y_range to true, this will be ignored
    # resolution: [600, 400]  #y, x
    cell_size: 0.1
    noise_level: 0.01
    length_scale: 0.6
    sigma_f: 0.5
    enable_visualization: true
    auto_x_y_range: false
    stiffness_range: [0, 2]
    auto_stiffness_range: false
    data_padding: 5.0  # Padding beyond data points (meters)
    no_data_alpha: 20
    enable_matplotlib_3d: false
    # Signal-to-Noise Ratio (SNR) Configuration:
    # SNR = |predicted_value| / uncertainty
    # SNR > 3: Generally trustworthy predictions (high confidence)
    # SNR 1-3: Moderate confidence predictions
    # SNR < 1: Low confidence predictions (noise dominates signal)
    snr_threshold: 1.0          # Threshold for trustworthy predictions
    alpha_high_confidence: 255  # Opacity for SNR >= threshold (trustworthy)
    alpha_low_confidence: 100   # Opacity for SNR < threshold (low confidence)
    # Confidence bounds visualization (same as safe_bayesian_optimization beta)
    confidence_beta: 3.0        # Confidence level multiplier for bounds (mu Â± beta * std)
    # Prior uncertainty for unexplored regions (should match sigma_f for consistency with GPR prior)
    prior_uncertainty: 25.0     # Matches sigma_f - uncertainty far from data
    # Safety threshold for safe set classification (should match safe_bayesian_optimization_node)
    f_max: 0.5                 # Safe if upper bound < f_max
    y_std_floor: 1.0


reactive_planner:
  ros__parameters:
    p: 20.0                    # R-function exponent
    epsilon: 0.1             # Distance for the switches
    varepsilon: 0.2              # Distance allowed to dilate the polygon
    mu_1: 1.0                 # Switch exponent mu1
    mu_2: 0.15                 # Switch exponent mu2
    robot_radius: 0.05        # Robot radius for collision avoidance (meters)
    linear_gain: 1.0          # Linear velocity gain
    angular_gain: 1.0         # Angular velocity gain
    linear_cmd_limit: 0.3     # Maximum linear velocity command (m/s)
    angular_cmd_limit: 2.0    # Maximum angular velocity command (rad/s)
    goal_tolerance: 0.02       # Distance tolerance to stop near subgoal (meters)
    next_subgoal_tolerance: 0.1  # Distance to switch to next subgoal (meters)


safe_bayesian_optimization_node:
  ros__parameters:
    opt:
      beta: 3.0
      f_max: 0.5
      lipschitz: 1.2
      subgoal_erosion: 0.2
      preference_order: ["g","g","e"]
    robot:
      radius: 0.05
      pose_topic: "spirit/current_pose"
    polygon:
      simplification_tolerance: 0.08  # Douglas-Peucker tolerance (m) - safe regions eroded by 1.5x before simplification for safety
      
    # Terrain map request parameters (auto-calculated from spatial data)
    terrain_map:
      resolution: [0.1, 0.1]   # [x_resolution, y_resolution] in meters per cell
      
    # Debug configuration
    debug:
      publish_debug_image: false
      
    # Node configuration
    node:
      update_rate: 10.0  # Hzterrain_x_resolution_
      log_level: "info"
      enable_visualization: true


goal_point_publisher:
  ros__parameters:
    exploration_mode: false
    waypoints: [5.0, 2.0, 0.0,     # First waypoint: x, y, z
                7.4, 3.5, 0.0,    # Second waypoint
                2.5, 0.5, 0.0]     # Third waypoin
#### below is simulator parameters. used for simulation.
drive_sim:
  ros__parameters:
    # Initial robot pose
    initial_x: 1.0
    initial_y: 2.0
    initial_theta: 0.0  # radians (0.0 = 0 degrees, 1.57 = 90 degrees, 3.14 = 180 degrees)
    
    # Slip model parameters for drive_sim
    wheel_radius: 0.2
    wheel_width: 0.05
    clearance_h: 0.0
    base_mass: 12.0
    payload_mass: 0.0
    excitation_frequency: 1.0


# note the file contains normalize x, and y as well as std x and std y.
ground_truth_server:
  ros__parameters:
    # Area boundaries (rectangular region)
    area_min_x: 0.0
    area_max_x: 20.0
    area_min_y: 0.0
    area_max_y: 4.0

    # Boundary behavior
    outside_value: 1.0
    max_border_slope: 2.0

    if_randomize: false
    map_file: ames_full  # set if_randomize: false and provide absolute path to use CSV
    # for random gaussian only

    # Number of Gaussian distributions
    # Higher values create denser variations
    num_gaussians: 300
    grid_resolution: 0.05  # must be double

    # Seed for reproducible Gaussian placement (-1 uses nondeterministic seed)
    random_seed: 42

    # Lipschitz constant controls the rate of change
    # Higher values create steeper gradients and more variation
    # Lower values create smoother transitions
    # Typical range: 1.0 (very smooth) to 50.0 (very steep)
    lipschitz_constant: 1.0

spatial_measurement_publisher:
  ros__parameters:
    pose_topic: spirit/current_pose
    measurement_topic: spirit/spatial_measurements
    publish_interval: 0.8
    service_name: sample_ground_truth
    source_name: ground_truth
    unit: unitless
    default_uncertainty: 0.0
    gaussian_noise_stddev: 0.01
    sample_count: 50
    sample_radius: 0.1
